/*
 jCanvas v13.06.08
 Copyright 2013 Caleb Evans
 Released under the MIT license
*/
(function(c,Ca,na,W,oa,w,G,f,y){function I(e){S(this,e);return this}function O(e){e?S(I.prototype,e):O.prefs=I.prototype=S({},da);return this}function Y(e){return"string"===Z(e)}function E(e){return e&&e.getContext?e.getContext("2d"):f}function Q(e,b){e.fillStyle=b.fillStyle;e.strokeStyle=b.strokeStyle;e.lineWidth=b.strokeWidth;b.rounded?(e.lineCap="round",e.lineJoin="round"):(e.lineCap=b.strokeCap,e.lineJoin=b.strokeJoin,e.miterLimit=b.miterLimit);e.shadowOffsetX=b.shadowX;e.shadowOffsetY=b.shadowY;
e.shadowBlur=b.shadowBlur;e.shadowColor=b.shadowColor;e.globalAlpha=b.opacity;e.globalCompositeOperation=b.compositing;b.imageSmoothing&&(e.webkitImageSmoothingEnabled=e.mozImageSmoothingEnabled=b.imageSmoothing)}function pa(e,b,a){a.mask&&(a.autosave&&(e.save(),b.savedTransforms=S({},b.transforms),b.transforms.masks+=1,b.transforms.withinMask=e.isPointInPath(b.event.x,b.event.y)?w:G),e.clip())}function ha(e,b,a){a.layer&&(a._args.withinMask=b.transforms.withinMask===w||b.transforms.withinMask===
f?w:G)}function T(e,b,a){a.closed&&b.closePath();a.shadowStroke&&0!==a.strokeWidth?(b.stroke(),b.fill(),b.shadowColor="transparent",b.shadowBlur=0,b.stroke()):(b.fill(),"transparent"!==a.fillStyle&&(b.shadowColor="transparent"),0!==a.strokeWidth&&b.stroke());a.closed||b.closePath();a._transformed&&b.restore();if(a.mask||a.layer)e=K(e),pa(b,e,a),ha(b,e,a)}function qa(e,b,a){b._toRad=b.inDegrees?M/180:1;e.translate(b.x,b.y);e.rotate(b.rotate*b._toRad);e.translate(-b.x,-b.y);a.rotate+=b.rotate*b._toRad}
function ra(e,b,a){1!==b.scale&&(b.scaleX=b.scaleY=b.scale);e.translate(b.x,b.y);e.scale(b.scaleX,b.scaleY);e.translate(-b.x,-b.y);a.scaleX*=b.scaleX;a.scaleY*=b.scaleY}function sa(e,b,a){b.translate&&(b.translateX=b.translateY=b.translate);e.translate(b.translateX,b.translateY);a.translateX+=b.translateX;a.translateY+=b.translateY}function P(e,b,a,d){b._toRad=b.inDegrees?M/180:1;b._transformed=w;e.save();d===y&&(d=a);!b.fromCenter&&!b._centered&&(b.x+=a/2,b.y+=d/2,b._centered=w);b.rotate&&qa(e,b,
{});(1!==b.scale||1!==b.scaleX||1!==b.scaleY)&&ra(e,b,{});(b.translate||b.translateX||b.translateY)&&sa(e,b,{})}function K(e){var b;L._canvas===e&&L._data?b=L._data:(b=c.data(e,"jCanvas"),b||(b={canvas:e,layers:[],layer:{names:{},groups:{}},intersects:[],drag:{},event:{type:f,x:f,y:f},events:{},transforms:{rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,masks:0,withinMask:f},animating:G,animated:f,pixelRatio:1,scaled:!1},b.savedTransforms=S({},b.transforms),c.data(e,"jCanvas",b)),L._canvas=e,
L._data=b);return b}function ta(e,b,a){for(var d in O.events)if(O.events.hasOwnProperty(d)){var h=e,g=b,j=a,c=d;j[c]&&(c=ia(c),O.events[c](h,g),j._event=w)}}function ua(e,b,a){var d,h,g;if(a.draggable||a.dragGroupWithLayer||a.cursor){d=["mousedown","mousemove","mouseup"];for(g=0;g<d.length;g+=1)h=ia(d[g]),O.events[h](e,b);b.events.mouseoutdrag||(e.bind("mouseout.jCanvas",function(){var a=b.drag.layer;a&&(b.drag={},e.drawLayers(),a.dragcancel&&a.dragcancel.call(e[0],a))}),b.events.mouseoutdrag=w);
a._event=w}}function ea(e,b,a,d){e=b.layer.names;d?d.name!==y&&(Y(a.name)&&a.group!==d.group)&&delete e[a.name]:d=a;Y(d.name)&&(e[d.name]=a)}function ja(e,b,a,d){e=b.layer.groups;var h,g;if(d){if(d.group!==y&&(Y(a.group)&&a.group!==d.group)&&(b=e[a.group])){for(g=0;g<b.length;g+=1)if(b[g]===a){h=g;b.splice(g,1);break}0===b.length&&delete e[a.group]}}else d=a;Y(d.group)&&(b=e[d.group],b||(b=e[d.group]=[],b.name=d.group),h===y&&(h=b.length),b.splice(h,0,a))}function N(e,b,a,d){var h=a;b._args=a;b.canvas=
e;b.draggable&&(b.layer=w,b.draggable=w);b._method=d?d:b.method?c.fn[b.method]:b.type?c.fn[va[b.type]]:function(){};b.layer&&!b._layer&&(a=c(e),d=a.getLayers(),e=K(e),h=new I(b),ea(a,e,h),ja(a,e,h),ta(a,e,h),ua(a,e,h),h.layer=w,h._layer=w,h.index===y&&(h.index=d.length),d.splice(h.index,0,h));return h}function wa(e){var b;for(b=0;b<V.length;b+=1)e[V[b]]=e["_"+V[b]]}function xa(e,b){var a;for(a=0;a<V.length;a+=1)e["_"+V[a]]=e[V[a]],ka[V[a]]=1,b&&delete e[V[a]]}function ya(e){var b,a,d=[],h=1;e.match(/^#?\w+$/i)&&
("transparent"===e&&(e="rgba(0,0,0,0)"),a=Ca.head,b=a.style.color,a.style.color=e,e=c.css(a,"color"),a.style.color=b);e.match(/^rgb/i)&&(d=e.match(/\d+/gi),e.match(/%/gi)&&(h=2.55),d[0]*=h,d[1]*=h,d[2]*=h,d[3]=d[3]!==y?oa(d[3]):1);return d}function Da(e){var b=3,a;"array"!==Z(e.start)&&(e.start=ya(e.start),e.end=ya(e.end));e.now=[];if(1!==e.start[3]||1!==e.end[3])b=4;for(a=0;a<b;a+=1)e.now[a]=e.start[a]+(e.end[a]-e.start[a])*e.pos,3>a&&(e.now[a]=Ea(e.now[a]));1!==e.start[3]||1!==e.end[3]?e.now="rgba("+
e.now.join(",")+")":(e.now.slice(0,3),e.now="rgb("+e.now.join(",")+")");e.elem.nodeName?e.elem.style[e.prop]=e.now:e.elem[e.prop]=e.now}function ia(e){"ontouchstart"in window&&la[e]&&(e=la[e]);return e}function U(e){O.events[e]=function(b,a){e=ia(e);var d="mouseover"===e||"mouseout"===e?"mousemove":e,h=a.event;a.events[d]||(b.bind(d+".jCanvas",function(a){h.x=a.offsetX;h.y=a.offsetY;h.type=d;h.event=a;b.drawLayers({resetFire:w});a.preventDefault()}),a.events[d]=w)}}function R(e,b,a){var d,h,g,j;a=
a._args;a._event&&(e=K(e),d=e.event,d.x!==f&&d.y!==f&&(g=d.x*e.pixelRatio,j=d.y*e.pixelRatio,h=b.isPointInPath(g,j)||b.isPointInStroke&&b.isPointInStroke(g,j)),b=e.transforms,a.eventX=a.mouseX=d.x,a.eventY=a.mouseY=d.y,a.event=d.event,d=e.transforms.rotate,g=a.eventX,j=a.eventY,0!==d?(a._eventX=g*X(-d)-j*$(-d),a._eventY=j*X(-d)+g*$(-d)):(a._eventX=g,a._eventY=j),a._eventX/=b.scaleX,a._eventY/=b.scaleY,!h&&(a._hovered&&!a._fired)&&(a._mousedout=w),h&&e.intersects.push(a))}function fa(e,b,a,d,h){b.save();
b.beginPath();b.rect(d[0],h[0],d[1]-d[0],h[1]-h[0]);b.clip();P(b,a,0);b.beginPath()}function ga(e,b,a){a._event&&R(e,b,a);b.restore();T(e,b,a)}function za(e,b){b.font?e.font=b.font:(isNaN(Number(b.fontSize))||(b.fontSize+="px"),e.font=b.fontStyle+" "+b.fontSize+" "+b.fontFamily)}function Aa(e,b){var a=b.text,d=b.maxWidth,h=a.split(" "),g=[],j="";if(e.measureText(a).width<d||1===h.length)g=[a];else{for(a=0;a<h.length;a+=1)e.measureText(j+h[a]).width>d&&(""!==j&&g.push(j),j=""),j+=h[a],a!==h.length-
1&&(j+=" ");g.push(j)}return g=g.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n")}var da,S=c.extend,aa=c.inArray,Z=c.type,ba=c.isFunction,Ea=W.round,M=W.PI,$=W.sin,X=W.cos,Fa=c.event.fix,la,ma,va,L={},V,ka;c.fn.jCanvas=O;O.events={};da={align:"center",autosave:w,baseline:"middle",bringToFront:G,ccw:G,closed:G,compositing:"source-over",concavity:0,cornerRadius:0,cropFromCenter:w,disableDrag:G,disableEvents:G,domain:f,draggable:G,group:f,data:{},each:f,end:360,fillStyle:"transparent",font:"",fontStyle:"normal",
fontSize:"12pt",fontFamily:"sans-serif",fromCenter:w,fn:f,graph:"y",height:f,imageSmoothing:w,inDegrees:w,lineHeight:1,layer:G,load:f,mask:G,maxWidth:f,miterLimit:10,name:f,opacity:1,projection:0,r1:f,r2:f,radius:0,range:f,repeat:"repeat",respectAlign:G,rotate:0,rounded:G,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowStroke:!1,shadowX:0,shadowY:0,sHeight:f,sides:0,source:"",start:0,strokeCap:"butt",strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:f,sx:f,sy:f,
text:"",translate:0,translateX:0,translateY:0,type:f,visible:w,width:f,x:0,y:0};O();O.extend=function(e){O.defaults=S(da,e.props);O();e.name&&(c.fn[e.name]=function a(d){var h,g,j,c=new I(d);for(g=0;g<this.length;g+=1)if(h=this[g],j=E(h))d=N(h,c,d,a),Q(j,c),e.fn.call(h,j,c);return this});return c.fn[e.name]};c.fn.getLayers=function(e){var b=this[0],a,d,h=[];if(b&&b.getContext)if(a=K(b).layers,ba(e))for(d=0;d<a.length;d+=1)e.call(b,a[d])&&h.push(a[d]);else h=a;return h};c.fn.getLayer=function(e){var b=
this.getLayers(),a=c.type(e),d=K(this[0]),h;if(e&&e.layer)h=e;else if("number"===a)0>e&&(e=b.length+e),h=b[e];else if("regexp"===a)for(a=0;a<b.length;a+=1){if(Y(b[a].name)&&b[a].name.match(e)){h=b[a];break}}else d=K(this[0]),h=d.layer.names[e];return h};c.fn.getLayerGroup=function(e){var b=c.type(e),a,d;if("array"===b)return e;if("regexp"===b)for(a in b=K(this[0]),b=b.groups,b){if(a.match(e)){d=b[a];break}}else b=K(this[0]),d=b.layer.groups[e];return d};c.fn.getLayerIndex=function(e){var b=this.getLayers();
e=this.getLayer(e);return aa(e,b)};c.fn.setLayer=function(e,b){var a,d,h,g;for(d=0;d<this.length;d+=1)if(a=c(this[d]),h=K(this[d]),g=c(this[d]).getLayer(e))ea(a,h,g,b),ja(a,h,g,b),S(g,b),ta(a,h,g),ua(a,h,g);return this};c.fn.setLayerGroup=function(e,b){var a,d,h,g;for(d=0;d<this.length;d+=1)if(a=c(this[d]),h=a.getLayerGroup(e))for(g=0;g<h.length;g+=1)a.setLayer(h[g],b);return this};c.fn.setLayers=function(e){var b,a,d,h;for(a=0;a<this.length;a+=1){b=c(this[a]);d=c(this[a]).getLayers();for(h=0;h<d.length;h+=
1)b.setLayer(d[h],e)}return this};c.fn.moveLayer=function(e,b){var a,d,h;for(d=0;d<this.length;d+=1)if(a=c(this[d]),h=a.getLayers(),a=a.getLayer(e))a.index=aa(a,h),h.splice(a.index,1),h.splice(b,0,a),0>b&&(b=h.length+b),a.index=b;return this};c.fn.removeLayer=function(e){var b,a,d,h,g;for(a=0;a<this.length;a+=1)if(b=c(this[a]),d=K(this[a]),h=b.getLayers(),g=b.getLayer(e))g.index=aa(g,h),h.splice(g.index,1),ea(b,d,g,{name:f}),ja(b,d,g,{group:f});return this};c.fn.removeLayerGroup=function(e){var b,
a,d,h,g,j,F;if(e!==y)for(a=0;a<this.length;a+=1)if(b=c(this[a]),d=K(this[a]),h=b.getLayers(),g=b.getLayerGroup(e)){for(F=0;F<g.length;F+=1)j=g[F],j.index=aa(j,h),h.splice(j.index,1),ea(b,d,j,{name:f});delete d.layer.groups[g.name]}return this};c.fn.removeLayers=function(){var e,b;for(e=0;e<this.length;e+=1)c(this[e]),b=K(this[e]),b.layers.length=0,b.layer.names={},b.layer.groups={};return this};c.fn.drawLayer=function b(a){var d,h,g,j;for(d=0;d<this.length;d+=1)g=c(this[d]),h=E(this[d]),j=g.getLayer(a),
b(g,h,j);return this};c.fn.drawLayers=function(b){var a,d,h=b||{},g,j,F,J,u,C;h.index||(h.index=0);for(b=0;b<this.length;b+=1)if(a=c(this[b]),d=E(this[b])){F=K(this[b]);if(0===h.index)for(g=0;g<F.transforms.masks;g+=1)a.restoreCanvas();h.clear!==G&&a.clearCanvas();d=F.layers;for(j=h.index;j<d.length&&!(g=d[j],g.index=j,h.resetFire&&(g._fired=G),g._event=!g.disableEvents,J=a,u=g,C=j+1,u&&(u.visible&&u._method)&&(u._next=C?C:f,u._method.call(J,u)),g._mousedout&&(g._mousedout=G,g._fired=w,g._hovered=
G,g.mouseout&&g.mouseout.call(this[b],g),g.cursor&&g._cursor&&a.css({cursor:g._cursor})),g._method===c.fn.drawImage&&g.visible);j+=1);if(0===h.index)for(g=0;g<F.transforms.masks;g+=1)a.restoreCanvas();g=F.intersects[F.intersects.length-1]||[];j=F.event;J=j.type;g[J]||ma[J]&&(J=ma[J]);C=g[J];u=F.drag;if(g._event&&g.withinMask===w){if((g.mouseover||g.mouseout||g.cursor)&&!g._hovered&&!g._fired)g._fired=w,g._hovered=w,g.mouseover&&g.mouseover.call(this[b],g),g.cursor&&(g._cursor=a.css("cursor"),a.css({cursor:g.cursor}));
C&&!g._fired&&(g._fired=w,j.type=f,C.call(this[b],g));if(g.draggable&&!g.disableDrag&&("mousedown"===J||"touchstart"===J)){g.bringToFront&&(d.splice(g.index,1),g.index=d.push(g));u.layer=g;u.dragging=w;if(u.layer.group&&u.layer.dragGroupWithLayer&&(a=F.layer.groups[u.layer.group]))for(j=0;j<a.length;j+=1)a[j]!==u.layer&&(a[j]._startX=a[j].x,a[j]._startY=a[j].y,a[j]._endX=g._eventX,a[j]._endY=g._eventY,a[j].bringToFront&&(a[j].index=aa(a[j],d),d.splice(a[j].index,1),d.splice(-1,0,a[j]),a[j].index=
d.length-2));u._startX=g._startX=g.x;u._startY=g._startY=g.y;u._endX=g._endX=g._eventX;u._endY=g._endY=g._eventY;g.dragstart&&g.dragstart.call(this[b],g)}}if(u.layer){if(u.dragging&&("mouseup"===J||"touchend"===J))u.layer.dragstop&&u.layer.dragstop.call(this[b],u.layer),F.drag={};if(u.dragging&&("mousemove"===J||"touchmove"===J))if(u.layer.x=u.layer._eventX-(u._endX-u._startX),u.layer.y=u.layer._eventY-(u._endY-u._startY),u.layer.drag&&u.layer.drag.call(this[b],u.layer),u.layer.group&&u.layer.dragGroupWithLayer&&
(a=F.layer.groups[u.layer.group]))for(j=0;j<a.length;j+=1)a[j]!==u.layer&&(a[j].x=u.layer._eventX-(a[j]._endX-a[j]._startX),a[j].y=u.layer._eventY-(a[j]._endY-a[j]._startY))}F.intersects=[]}return this};c.fn.addLayer=function(b){var a,d,h;h=new I(b);for(a=0;a<this.length;a+=1)if(d=E(this[a]))h.layer=w,b=N(this[a],h,b);return this};V=["width","height","opacity","lineHeight"];ka={};c.fn.animateLayer=function(){function b(a,b,d){return function(){wa(d);(!b.animating||b.animated===d)&&a.drawLayers();
j[4]&&j[4].call(a[0],d);d._animating=G;b.animating=G;b.animated=f}}function a(a,b,d){return function(g,h){wa(d);!d._animating&&!b.animating&&(d._animating=w,b.animating=w,b.animated=d);(!b.animating||b.animated===d)&&a.drawLayers();j[5]&&j[5].call(a[0],g,h,d)}}var d,h,g,j=[].slice.call(arguments,0),F,J;"object"===Z(j[0])&&!j[0].layer&&j.unshift(0);"object"===Z(j[2])?(j.splice(2,0,j[2].duration||f),j.splice(3,0,j[3].easing||f),j.splice(4,0,j[4].complete||f),j.splice(5,0,j[5].step||f)):(j[2]===y?(j.splice(2,
0,f),j.splice(3,0,f),j.splice(4,0,f)):ba(j[2])&&(j.splice(2,0,f),j.splice(3,0,f)),j[3]===y?(j[3]=f,j.splice(4,0,f)):ba(j[3])&&j.splice(3,0,f));for(h=0;h<this.length;h+=1)if(d=c(this[h]),g=E(this[h]))if(g=K(this[h]),(F=d.getLayer(j[0]))&&F._method!==c.fn.draw){J=S({},j[1]);var u=this[h],C=F,z=void 0;for(z in J)J.hasOwnProperty(z)&&ba(J[z])&&(J[z]=J[z].call(u,C,z));xa(J,w);xa(F);F.style=ka;c(F).animate(J,{duration:j[2],easing:c.easing[j[3]]?j[3]:f,complete:b(d,g,F),step:a(d,g,F)})}return this};c.fn.animateLayerGroup=
function(b){var a,d,h=[].slice.call(arguments,0),g,j;for(d=0;d<this.length;d+=1){a=c(this[d]);g=a.getLayerGroup(b);for(j=0;j<g.length;j+=1)a.animateLayer.apply(a,[g[j]].concat(h.slice(1)))}return this};c.fn.delayLayer=function(b,a){var d,h;a=a||0;for(d=0;d<this.length;d+=1)h=c(this[d]).getLayer(b),c(h).delay(a);return this};c.fn.delayLayerGroup=function(b,a){var d,h,g,j;a=a||0;for(h=0;h<this.length;h+=1)if(d=c(this[h]),d=d.getLayerGroup(b))for(j=0;j<d.length;j+=1)(g=d[j])&&c(g).delay(a);return this};
c.fn.stopLayer=function(b,a){var d,h;for(d=0;d<this.length;d+=1)(h=c(this[d]).getLayer(b))&&c(h).stop(a);return this};c.fn.stopLayerGroup=function(b,a){var d,h,g,j;for(h=0;h<this.length;h+=1)if(d=c(this[h]),d=d.getLayerGroup(b))for(j=0;j<d.length;j+=1)(g=d[j])&&c(g).stop(a);return this};var Ba="color backgroundColor borderColor borderTopColor borderRightColor borderBottomColor borderLeftColor fillStyle outlineColor strokeStyle shadowColor".split(" "),ca;for(ca=0;ca<Ba.length;ca+=1)c.fx.step[Ba[ca]]=
Da;la={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"};ma={touchstart:"mousedown",touchend:"mouseup",touchmove:"mousemove"};U("click");U("dblclick");U("mousedown");U("mouseup");U("mousemove");U("mouseover");U("mouseout");U("touchstart");U("touchmove");U("touchend");c.event.fix=function(b){var a,d;b=Fa.call(c.event,b);if(a=b.originalEvent)if(d=a.changedTouches,b.pageX!==y&&b.offsetX===y){if(a=c(b.target).offset())b.offsetX=b.pageX-a.left,b.offsetY=b.pageY-a.top}else if(d&&(a=c(a.target).offset()))b.offsetX=
d[0].pageX-a.left,b.offsetY=d[0].pageY-a.top;return b};va={arc:"drawArc",bezier:"drawBezier",circle:"drawArc",ellipse:"drawEllipse","function":"draw",image:"drawImage",line:"drawLine",polygon:"drawPolygon",quadratic:"drawQuadratic",rectangle:"drawRect",text:"drawText",vector:"drawVector"};c.fn.draw=function a(d){var h,g,j,f;f=new I(d);for(g=0;g<this.length;g+=1)if(h=c(this[g]),j=E(this[g]))d=N(this[g],f,d),f.visible&&(f.fn?f.fn.call(this[g],j,f):f._method!==a&&f._method.call(h,d));return this};c.fn.clearCanvas=
function(a){var d,h=new I(a);for(a=0;a<this.length;a+=1)if(d=E(this[a]))!h.x||!h.y||!h.width||!h.height?(d.save(),d.setTransform(1,0,0,1,0,0),d.clearRect(0,0,this[a].width,this[a].height)):(P(d,h,h.width,h.height),d.clearRect(h.x-h.width/2,h.y-h.height/2,h.width,h.height)),d.restore();return this};c.fn.saveCanvas=function(){var a,d,h;for(a=0;a<this.length;a+=1)if(d=E(this[a]))h=K(this[a]),d.save(),h.savedTransforms=S({},h.transforms);return this};c.fn.restoreCanvas=function(){var a,d,h;for(a=0;a<
this.length;a+=1)if(d=E(this[a]))h=K(this[a]),d.restore(),h.transforms=S({},h.savedTransforms);return this};c.fn.restoreCanvasOnRedraw=function(a){var d={layer:w,fn:function(){c(this).restoreCanvas()}};S(d,a);return this.draw(d)};c.fn.rotateCanvas=function d(h){var g,j,c=new I(h),f;for(g=0;g<this.length;g+=1)if(j=E(this[g]))f=K(this[g]),h=N(this[g],c,h,d),c.autosave&&j.save(),qa(j,c,f.transforms);return this};c.fn.scaleCanvas=function h(g){var j,c,f=new I(g),u;for(j=0;j<this.length;j+=1)if(c=E(this[j]))u=
K(this[j]),g=N(this[j],f,g,h),f.autosave&&c.save(),ra(c,f,u.transforms);return this};c.fn.translateCanvas=function g(j){var c,f,u=new I(j),C;for(c=0;c<this.length;c+=1)if(f=E(this[c]))C=K(this[c]),j=N(this[c],u,j,g),u.autosave&&f.save(),sa(f,u,C.transforms);return this};c.fn.drawRect=function j(c){var f,u,C=new I(c),z,B,A,D,x;for(f=0;f<this.length;f+=1)if(u=E(this[f]))c=N(this[f],C,c,j),C.visible&&(Q(u,C),P(u,C,C.width,C.height),u.beginPath(),z=C.x-C.width/2,B=C.y-C.height/2,(x=C.cornerRadius)?(C.closed=
w,A=C.x+C.width/2,D=C.y+C.height/2,0>A-z-2*x&&(x=(A-z)/2),0>D-B-2*x&&(x=(D-B)/2),u.moveTo(z+x,B),u.lineTo(A-x,B),u.arc(A-x,B+x,x,3*M/2,2*M,G),u.lineTo(A,D-x),u.arc(A-x,D-x,x,0,M/2,G),u.lineTo(z+x,D),u.arc(z+x,D-x,x,M/2,M,G),u.lineTo(z,B+x),u.arc(z+x,B+x,x,M,3*M/2,G)):u.rect(z,B,C.width,C.height),C._event&&R(this[f],u,C),T(this[f],u,C));return this};c.fn.drawArc=function F(c){var f,C,z=new I(c);c=c||{};z.layer&&(!z.inDegrees&&360===z.end)&&(c.end=z.end=2*M);for(f=0;f<this.length;f+=1)if(C=E(this[f]))c=
N(this[f],z,c,F),z.visible&&(Q(C,z),P(C,z,2*z.radius),C.beginPath(),C.arc(z.x,z.y,z.radius,z.start*z._toRad-M/2,z.end*z._toRad-M/2,z.ccw),z._event&&R(this[f],C,z),T(this[f],C,z));return this};c.fn.drawEllipse=function J(c){var f,z,B=new I(c),A=4*B.width/3,D=B.height;B.closed=w;for(f=0;f<this.length;f+=1)if(z=E(this[f]))c=N(this[f],B,c,J),B.visible&&(Q(z,B),P(z,B,B.width,B.height),z.beginPath(),z.moveTo(B.x,B.y-D/2),z.bezierCurveTo(B.x-A/2,B.y-D/2,B.x-A/2,B.y+D/2,B.x,B.y+D/2),z.bezierCurveTo(B.x+A/
2,B.y+D/2,B.x+A/2,B.y-D/2,B.x,B.y-D/2),B._event&&R(this[f],z,B),T(this[f],z,B));return this};c.fn.drawPolygon=function u(c){var f,B,A=new I(c),D=2*M/A.sides,x=M/A.sides,t=x+M/2,q=A.radius*X(D/2),m,k,p;A.closed=w;A.projection&&(A.concavity=-A.projection);for(f=0;f<this.length;f+=1)if(B=E(this[f]))if(c=N(this[f],A,c,u),A.visible){Q(B,A);P(B,A,2*A.radius);B.beginPath();for(p=0;p<A.sides;p+=1)m=A.x+A.radius*X(t),k=A.y+A.radius*$(t),B.lineTo(m,k),A.concavity&&(m=A.x+(q+-q*A.concavity)*X(t+x),k=A.y+(q+
-q*A.concavity)*$(t+x),B.lineTo(m,k)),t+=D;A._event&&R(this[f],B,A);T(this[f],B,A)}return this};c.fn.drawLine=function C(c){var f,A,D=new I(c),x,t,q;for(f=0;f<this.length;f+=1)if(A=E(this[f]))if(c=N(this[f],D,c,C),D.visible){Q(A,D);P(A,D,0);x=1;for(A.beginPath();w;)if(t=D["x"+x],q=D["y"+x],t!==y&&q!==y)A.lineTo(t+D.x,q+D.y),x+=1;else break;D._event&&R(this[f],A,D);T(this[f],A,D)}return this};c.fn.drawQuadratic=c.fn.drawQuad=function z(c){var f,D,x=new I(c),t,q,m,k,p;for(f=0;f<this.length;f+=1)if(D=
E(this[f]))if(c=N(this[f],x,c,z),x.visible){Q(D,x);P(D,x,0);t=2;D.beginPath();for(D.moveTo(x.x1+x.x,x.y1+x.y);w;)if(q=x["x"+t],m=x["y"+t],k=x["cx"+(t-1)],p=x["cy"+(t-1)],q!==y&&m!==y&&k!==y&&p!==y)D.quadraticCurveTo(k+x.x,p+x.y,q+x.x,m+x.y),t+=1;else break;x._event&&R(this[f],D,x);T(this[f],D,x)}return this};c.fn.drawBezier=function B(c){var f,x,t=new I(c),q,m,k,p,s,r,n,v;for(f=0;f<this.length;f+=1)if(x=E(this[f]))if(c=N(this[f],t,c,B),t.visible){Q(x,t);P(x,t,0);q=2;m=1;x.beginPath();for(x.moveTo(t.x1+
t.x,t.y1+t.y);w;)if(k=t["x"+q],p=t["y"+q],s=t["cx"+m],r=t["cy"+m],n=t["cx"+(m+1)],v=t["cy"+(m+1)],k!==y&&p!==y&&s!==y&&r!==y&&n!==y&&v!==y)x.bezierCurveTo(s+t.x,r+t.y,n+t.x,v+t.y,k+t.x,p+t.y),q+=1,m+=2;else break;t._event&&R(this[f],x,t);T(this[f],x,t)}return this};c.fn.drawVector=function A(f){var c,t,q=new I(f),m,k,p,s,r;for(c=0;c<this.length;c+=1)if(t=E(this[c]))if(f=N(this[c],q,f,A),q.visible){Q(t,q);P(t,q,0);m=1;t.beginPath();s=q.x;r=q.y;for(t.moveTo(q.x,q.y);w;)if(k=q["a"+m],p=q["l"+m],k!==
y&&p!==y)k=k*q._toRad-M/2,s+=p*W.cos(k),r+=p*W.sin(k),t.lineTo(s,r),m+=1;else break;q._event&&R(this[c],t,q);T(this[c],t,q)}return this};c.fn.drawGraph=function D(c){var t,q,m=new I(c),k,p,s,r,n,v;for(t=0;t<this.length;t+=1)if((q=E(this[t]))&&m.fn)if(c=N(this[t],m,c,D),m.visible){Q(q,m);k=m.graph;p=m.domain;s=m.range;r=this[t].width;n=this[t].height;p===f&&(p=[f,f]);p[0]===f&&(p[0]=0);p[1]===f&&(p[1]=r);s===f&&(s=[f,f]);s[0]===f&&(s[0]=0);s[1]===f&&(s[1]=n);fa(t,q,m,p,s);if("y"===k)for(k=p[0]-m.x;k<=
p[1]-m.x;k+=1)r=m.fn(k,m),r===f?(ga(this[t],q,m),fa(t,q,m,p,s)):q.lineTo(k+m.x,r+m.y);else if("x"===k)for(r=s[0]-m.y;r<=s[1]-m.y;r+=1)k=m.fn(r,m),k===f?(ga(this[t],q,m),fa(t,q,m,p,s)):q.lineTo(k+m.x,r+m.y);else if("r"===k)for(v=0;v<2*M;v+=M/180)n=m.fn(v,m),k=n*X(v),r=n*$(v),n===f?(ga(this[t],q,m),fa(q,m,p,s)):q.lineTo(k+m.x,r+m.y);ga(this[t],q,m)}return this};c.fn.drawText=function x(t){var q,m,k=new I(t),p,s,r,n;for(q=0;q<this.length;q+=1)if(c(this[q]),m=E(this[q]))if(t=N(this[q],k,t,x),k.visible){Q(m,
k);m.textBaseline=k.baseline;m.textAlign=k.align;za(m,k);!q&&k.maxWidth!==f?p=Aa(m,k):q||(p=String(k.text).split("\n"));if(!q){s=this[q];n=m;var v=k,l=p,H=void 0,w=void 0,y=/\b(\d*\.?\d*)\w\w\b/gi,w=H=void 0;if(L.text===v.text&&L.font===v.font&&L.fontStyle===v.fontStyle&&L.fontSize===v.fontSize&&L.fontFamily===v.fontFamily&&L.maxWidth===v.maxWidth&&L.lineHeight===v.lineHeight)v.width=L.width,v.height=L.height;else{v.width=n.measureText(l[0]).width;for(H=1;H<l.length;H+=1)w=n.measureText(l[H]).width,
w>v.width&&(v.width=w);H=s.style.fontSize;if(v.font){if(w=v.font.match(y))s.style.fontSize=v.font.match(y)[0]}else s.style.fontSize=v.fontSize;v.height=oa(c.css(s,"fontSize"))*l.length*v.lineHeight;s.style.fontSize=H}}P(m,k,k.width,k.height);q||(r=k.x,"left"===k.align&&!k.respectAlign?r-=k.width/2:"right"===k.align&&!k.respectAlign&&(r+=k.width/2));for(s=0;s<p.length;s+=1)m.shadowColor=k.shadowColor,n=k.y+s*k.height/p.length-(p.length-1)*k.height/p.length/2,m.fillText(p[s],r,n),"transparent"!==k.fillStyle&&
(m.shadowColor="transparent"),m.strokeText(p[s],r,n);k._event?(m.beginPath(),m.rect(k.x-k.width/2,k.y-k.height/2,k.width,k.height),m.restore(),R(this[q],m,k),m.closePath(),ha(m,K(this[q]),k)):m.restore()}L=k;return this};c.fn.measureText=function t(c){var f,k;f=c!==y&&("object"!==Z(c)||c.layer)?this.getLayer(c):new I(c);if(c=E(this[0]))za(c,f),k=Aa(c,f),t(this[0],c,f,k);return f};c.fn.drawImage=function q(m){function k(k,q,n){return function(){0===q&&(l.width===f&&l.sWidth===f&&(l.width=l.sWidth=
H.width),l.height===f&&l.sHeight===f&&(l.height=l.sHeight=H.height),m&&l.layer&&(m.width=l.width,m.height=l.height),Q(n,l),l.sWidth!==f&&l.sHeight!==f&&l.sx!==f&&l.sy!==f?(l.width===f&&(l.width=l.sWidth),l.height===f&&(l.height=l.sHeight),l.cropFromCenter||(l.sx+=l.sWidth/2,l.sy+=l.sHeight/2),l.sx+l.sWidth/2>H.width&&(l.sx=H.width-l.sWidth/2),0>l.sx-l.sWidth/2&&(l.sx=l.sWidth/2),0>l.sy-l.sHeight/2&&(l.sy=l.sHeight/2),l.sy+l.sHeight/2>H.height&&(l.sy=H.height-l.sHeight/2),P(n,l,l.width,l.height),n.drawImage(H,
l.sx-l.sWidth/2,l.sy-l.sHeight/2,l.sWidth,l.sHeight,l.x-l.width/2,l.y-l.height/2,l.width,l.height)):(P(n,l,l.width,l.height),n.drawImage(H,l.x-l.width/2,l.y-l.height/2,l.width,l.height)));n.beginPath();n.rect(l.x-l.width/2,l.y-l.height/2,l.width,l.height);l._event&&R(p[q],n,l);l._transformed&&n.restore();v=K(p[q]);n.closePath();n.stroke();pa(n,v,l);ha(n,v,l);l.load&&l.load.call(k,m);l.layer&&l._next&&c(k).drawLayers({clear:G,resetFire:w,index:l._next})}}var p=this,s,r,n,v,l=new I(m),H,y;s=l.source;
y=s.getContext;s.src||y?H=s:s&&(L.source===s?H=L._source:(H=new na,H.src=s,L.source=s,L._source=H));for(r=0;r<p.length;r+=1)if(s=p[r],n=E(p[r]))m=N(p[r],l,m,q),l.visible&&H&&(H.complete||y?k(s,r,n)():(c(H).bind("load",k(s,r,n)),H.src=H.src));return p};c.fn.createPattern=c.fn.pattern=function(q){function m(){n=p.createPattern(r,s.repeat);s.load&&s.load.call(k[0],n)}var k=this,p,s=new I(q),r,n,v;(p=E(k[0]))?(v=s.source,ba(v)?(r=c("<canvas />")[0],r.width=s.width,r.height=s.height,q=E(r),v.call(r,q),
m()):(q=v.getContext,v.src||q?r=v:(r=new na,r.src=v),r.complete||q?m():(c(r).bind("load",m),r.src=r.src))):n=f;return n};c.fn.createGradient=c.fn.gradient=function(c){var m;c=new I(c);var k=[],p,s,r,n,v,l,w;if(m=E(this[0])){c.x1=c.x1||0;c.y1=c.y1||0;c.x2=c.x2||0;c.y2=c.y2||0;m=c.r1!==f||c.r2!==f?m.createRadialGradient(c.x1,c.y1,c.r1,c.x2,c.y2,c.r2):m.createLinearGradient(c.x1,c.y1,c.x2,c.y2);for(n=1;c["c"+n]!==y;n+=1)c["s"+n]!==y?k.push(c["s"+n]):k.push(f);p=k.length;k[0]===f&&(k[0]=0);k[p-1]===f&&
(k[p-1]=1);for(n=0;n<p;n+=1){if(k[n]!==f){l=1;w=0;s=k[n];for(v=n+1;v<p;v+=1)if(k[v]!==f){r=k[v];break}else l+=1;s>r&&(k[v]=k[n])}else k[n]===f&&(w+=1,k[n]=s+w*((r-s)/l));m.addColorStop(k[n],c["c"+(n+1)])}}else m=f;return m};c.fn.setPixels=function m(c){var p,s,r,n=new I(c),v={},l,w,y,G;for(s=0;s<this.length;s+=1)if(p=this[s],r=E(p)){c=N(p,n,c,m);P(r,n,n.width,n.height);if(n.width===f||n.height===f)n.width=p.width,n.height=p.height,n.x=n.width/2,n.y=n.height/2;if(0!==n.width&&0!==n.height){l=r.getImageData(n.x-
n.width/2,n.y-n.height/2,n.width,n.height);w=l.data;G=w.length;v=[];if(n.each)for(y=0;y<G;y+=4)v.r=w[y],v.g=w[y+1],v.b=w[y+2],v.a=w[y+3],n.each.call(p,v),w[y]=v.r,w[y+1]=v.g,w[y+2]=v.b,w[y+3]=v.a;r.putImageData(l,n.x-n.width/2,n.y-n.height/2);r.restore()}}return this};c.fn.getCanvasImage=function(c,k){var p=this[0];k===y&&(k=1);return p&&p.toDataURL?p.toDataURL("image/"+c,k):f};c.fn.detectPixelRatio=function(f){var k,p,s,r,n,v,l;for(p=0;p<this.length;p+=1)k=this[p],c(this[p]),s=E(k),l=K(this[p]),
l.scaled||(r=window.devicePixelRatio||1,n=s.webkitBackingStorePixelRatio||s.mozBackingStorePixelRatio||s.msBackingStorePixelRatio||s.oBackingStorePixelRatio||s.backingStorePixelRatio||1,r/=n,1!==r&&(n=k.width,v=k.height,k.width=n*r,k.height=v*r,k.style.width=n+"px",k.style.height=v+"px",s.scale(r,r)),l.pixelRatio=r,l.scaled=w,f&&f.call(k,r));return this};c.support.canvas=c("<canvas />")[0].getContext!==y;O.defaults=da;O._detectEvents=R;O.closePath=T;c.jCanvas=O})(jQuery,document,Image,Math,parseFloat,
!0,!1,null);
